# PWA Configuration Summary - Login Page Install

## ‚úÖ Configuration Complete

The PWA is now configured to show install prompt **instantly** on the `/login` page (first page users see).

---

## üìã Changes Made

### 1. **manifest.json** Updated

```json
{
  "start_url": "/login",     // Login is entry point
  "scope": "/",               // Works across all routes
  "orientation": "landscape", // Force landscape on tablets
  ...
}
```

**Effect**: PWA starts at login page and works across all routes.

### 2. **PWAInstallPrompt.jsx** Updated

- Added `usePathname()` from `next/navigation`
- Added route check: `const isOnLoginRoute = pathname === "/login"`
- Install prompt only shows when `isOnLoginRoute === true`
- **No delay** - Prompt appears instantly when login page loads

**Effect**: Install prompt appears INSTANTLY on `/login` route (first page users see).

### 3. **CASHIER_PWA_INSTALL.md** Created

Complete installation guide for cashiers with:

- Why install PWA (benefits)
- Platform-specific instructions (Android/iOS/Desktop)
- Screenshots locations
- Troubleshooting section
- Important notes for cashiers vs admins

---

## üéØ How It Works

### For All Users (on /login)

1. Visit `https://your-domain.com` ‚Üí Redirects to `/login`
2. Login page loads ‚Üí Install prompt appears **instantly**
3. Click "Install" ‚Üí App installs
4. Access via "CK POS" icon on device

### For Admins (on /admin)

1. Visit any admin route (`/admin/dashboard`, `/admin/products`, etc.)
2. **No install prompt appears** (route check prevents it)
3. Use regular browser normally
4. Full access to all admin features

---

## üîç Technical Details

### Manifest Scope

```json
"scope": "/sales"
```

- PWA is isolated to `/sales` route
- Navigating outside `/sales` from PWA will open in browser
- Admin routes are never part of the PWA

### Prompt Logic

```javascript
const isOnSalesRoute = pathname === "/sales";

// Only show if:
// 1. On /sales route
// 2. beforeinstallprompt event fired
// 3. Not dismissed within last 7 days
// 4. Not already installed
```

### Benefits by Role

| Feature         | Cashiers (PWA)       | Admins (Browser)     |
| --------------- | -------------------- | -------------------- |
| Install prompt  | ‚úÖ Shows on /sales   | ‚ùå Never shows       |
| Offline support | ‚úÖ Full support      | ‚ö†Ô∏è Limited           |
| Fast loading    | ‚úÖ Cached assets     | ‚ö†Ô∏è Network-dependent |
| Browser tabs    | ‚ùå No tabs (focused) | ‚úÖ Multiple tabs     |
| DevTools access | ‚ö†Ô∏è Limited           | ‚úÖ Full access       |
| Updates         | üîÑ Auto-update       | ‚ûñ N/A               |

---

## üì± Installation Instructions

### Quick Start for Cashiers

1. Open browser on device
2. Go to `/sales` page
3. Login with credentials
4. Wait 30 seconds for install prompt
5. Click "Install"
6. Launch from app icon

### Full Guide

See **[CASHIER_PWA_INSTALL.md](./CASHIER_PWA_INSTALL.md)** for:

- Platform-specific steps (Android/iOS/Desktop)
- Alternative installation methods
- Troubleshooting
- Uninstall instructions

---

## üöÄ Testing

### Test PWA Installation

1. **Production build required**:

   ```powershell
   npm run build
   npm start
   ```

   (PWA doesn't work in `npm run dev`)

2. **Visit /sales route**:

   - Navigate to `http://localhost:3000/sales`
   - Wait 30 seconds
   - Install prompt should appear

3. **Verify admin routes**:
   - Navigate to `http://localhost:3000/admin/dashboard`
   - Wait 30 seconds
   - Install prompt should NOT appear

### Test Chrome DevTools

1. Open Chrome DevTools (F12)
2. **Application Tab**:
   - Check "Manifest" ‚Üí Should show scope: "/sales"
   - Check "Service Workers" ‚Üí Should be registered
3. **Lighthouse**:
   - Run PWA audit
   - Should score 100% for installability

---

## ‚ö†Ô∏è Important Notes

### For Deployment

1. **HTTPS Required**: PWA only works on HTTPS (localhost exempt)
2. **Valid SSL Certificate**: Browsers require trusted SSL
3. **Service Worker**: Auto-generated by `next-pwa`
4. **Icon Files**: Ensure all icon files exist in `/public/icons/`

### For Users

- **Cashiers**: Must install PWA from `/sales` for best experience
- **Admins**: Should NOT install PWA, use browser normally
- **Updates**: PWA auto-updates when app is closed and reopened
- **Offline**: Basic features work offline, sync when back online

### Troubleshooting

- **Prompt doesn't appear**: Check if on `/sales` route, wait 30s, try manual install
- **Can't install**: Check browser console for errors, verify production build
- **Already dismissed**: Clear site data or wait 7 days, or use manual install
- **Icons missing**: Run `node scripts/generate-icons.js` to regenerate

---

## üìö Documentation Files

| File                       | Purpose                             | Audience   |
| -------------------------- | ----------------------------------- | ---------- |
| **PWA_SETUP.md**           | Technical setup and developer guide | Developers |
| **CASHIER_PWA_INSTALL.md** | Step-by-step installation guide     | Cashiers   |
| **CASHIER_LOGIN.md**       | Login instructions                  | Cashiers   |
| **CASHIER_QUICK_START.md** | Quick start guide                   | Cashiers   |

---

## ‚úÖ Verification Checklist

- [x] manifest.json `start_url` set to "/sales"
- [x] manifest.json `scope` set to "/sales"
- [x] PWAInstallPrompt checks pathname === "/sales"
- [x] Install prompt only shows on /sales route
- [x] Install prompt never shows on /admin routes
- [x] CASHIER_PWA_INSTALL.md created with full guide
- [x] PWA_SETUP.md updated with role-based instructions
- [x] Service worker configured via next-pwa
- [x] All icon files present in /public/icons/

---

## üéâ Ready to Use!

The PWA is now properly configured for cashier-only installation. Cashiers can install from `/sales` for the best experience, while admins continue to use the regular browser for full functionality.

**Next Steps:**

1. Deploy to production (HTTPS required)
2. Share [CASHIER_PWA_INSTALL.md](./CASHIER_PWA_INSTALL.md) with cashiers
3. Test installation on actual devices
4. Monitor PWA analytics in Chrome DevTools
