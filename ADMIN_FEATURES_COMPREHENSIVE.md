# Comprehensive Admin Features Documentation

## Overview

This document provides a complete overview of all admin features and capabilities in the Candy Kush POS system. This documentation is designed to help create an equivalent admin app using Xcode, ensuring all features match the web interface.

## Table of Contents

1. [Authentication & Access Control](#authentication--access-control)
2. [Dashboard](#dashboard)
3. [Sales Reports](#sales-reports)
4. [Product Management](#product-management)
5. [Stock Management](#stock-management)
6. [Order Management](#order-management)
7. [Customer Management](#customer-management)
8. [Expense Management](#expense-management)
9. [Cashback System](#cashback-system)
10. [User Management](#user-management)
11. [Analytics](#analytics)
12. [Settings & Configuration](#settings--configuration)
13. [API Endpoints](#api-endpoints)

---

## Authentication & Access Control

### Admin Role Requirements
- Only users with `role: "admin"` can access admin panel
- JWT token validation required for all admin operations
- Automatic logout on token expiration

### Permission Levels
- **Admin**: Full access to all features
- **Cashier**: Limited access (POS operations only)
- **Employee**: Can create expenses, limited product access

---

## Dashboard

### Key Metrics Displayed
- **Total Revenue**: Current period revenue with comparison
- **Gross Profit**: Profit calculations with margin percentage
- **Today's Sales**: Daily revenue with day-over-day change
- **Month Orders**: Order count with period comparison
- **Average Order Value**: AOV with trend analysis
- **Customer Insights**: New vs returning customer metrics

### Charts & Visualizations
- **Daily Sales Chart**: Revenue trends over time
- **Monthly Revenue Chart**: Year-over-year comparison
- **Payment Methods Distribution**: Pie/bar chart of payment types
- **Top Products**: Best-selling items with quantities and revenue
- **Top Customers**: Highest spending customers
- **Recent Transactions**: Latest sales activity

### Features
- **Date Range Selection**: Custom periods or predefined ranges
- **Category Filtering**: Filter dashboard by product categories
- **Real-time Updates**: Live data refresh capabilities
- **Export Options**: Data export functionality

---

## Sales Reports

### 1. Sales Summary
- **Time Period Selection**: Day, week, month grouping
- **Chart Types**: Area charts and bar charts
- **Metrics**: Gross sales, net sales, discounts, taxes
- **Employee Filtering**: Filter by specific cashiers
- **Time Range Filtering**: Business hours analysis

### 2. Sales by Item
- **Product Performance**: Revenue and quantity by product
- **Category Breakdown**: Sales grouped by categories
- **Trend Analysis**: Historical performance tracking
- **Top/Bottom Performers**: Best and worst-selling items

### 3. Sales by Category
- **Category Revenue**: Sales performance by product categories
- **Sub-category Analysis**: Drill-down capabilities
- **Comparison Charts**: Category vs category analysis
- **Seasonal Trends**: Time-based category performance

### 4. Sales by Employee
- **Cashier Performance**: Revenue generated by each employee
- **Transaction Counts**: Number of sales per employee
- **Average Order Values**: Performance metrics
- **Time-based Analysis**: Peak hours performance

### 5. Sales by Payment Method
- **Payment Type Distribution**: Cash, card, digital payments
- **Revenue by Payment**: Which methods generate most revenue
- **Transaction Analysis**: Payment method preferences
- **Trend Tracking**: Payment method adoption over time

### 6. Receipts Report
- **Receipt History**: Complete transaction records
- **Receipt Details**: Line items, discounts, taxes
- **Customer Information**: Receipt attribution
- **Time-based Filtering**: Date range selection

### 7. Discounts Report
- **Discount Usage**: Types and frequency of discounts
- **Revenue Impact**: Discount effect on sales
- **Customer Analysis**: Which customers use discounts
- **Trend Analysis**: Discount effectiveness over time

### 8. Shifts Report
- **Shift Management**: Employee shift tracking
- **Revenue by Shift**: Performance per shift
- **Time Analysis**: Peak shift identification
- **Labor Cost Analysis**: Shift-based cost tracking

---

## Sold Items Tracking

### Overview
Detailed tracking of all sold items across all transactions with comprehensive filtering and analysis capabilities.

### Features
- **Product Sales Analytics**: Complete view of all products sold
- **Category Filtering**: Filter sold items by product categories
- **Date Range Selection**: Custom date ranges for analysis
- **Search Functionality**: Search by product name
- **Quantity Tracking**: Total units sold per product
- **Revenue Tracking**: Total revenue per product
- **Performance Metrics**: Best and worst performing items

### Data Points
- Product name and SKU
- Total quantity sold
- Total revenue generated
- Average price per unit
- Category classification
- Time period analysis

---

## Transactions View

### Overview
Comprehensive transaction history with detailed receipt information and search capabilities.

### Features
- **Transaction List**: All sales transactions with receipts
- **Search & Filter**: Search by customer, amount, date
- **Receipt Details**: View complete transaction information
- **Date Range Filtering**: Custom date ranges (today, week, month, custom)
- **Customer Tracking**: Link transactions to customers
- **Payment Method View**: See payment types used
- **Product Line Items**: Detailed item-level information

### Transaction Details Include
- Receipt ID and number
- Date and time of transaction
- Customer information
- Employee who processed sale
- Line items (products, quantities, prices)
- Subtotals and totals
- Payment methods used
- Discounts applied
- Tax calculations

---

## Product Management

### Product List Features
- **Product Catalog**: Complete inventory listing
- **Search & Filtering**: Name, category, availability filters
- **Bulk Operations**: Multi-select editing and deletion
- **Stock Tracking**: Real-time inventory levels
- **Price Management**: Retail and wholesale pricing

### Product Details
- **Basic Information**: Name, description, SKU
- **Pricing**: Multiple price tiers, currency support
- **Categories**: Hierarchical category system
- **Images**: Product photo management
- **Variants**: Size, color, style variations
- **Stock Levels**: Current quantity, low stock alerts

### Category Management
- **Category Creation**: Add new product categories
- **Hierarchy Support**: Parent/child category relationships
- **Color Coding**: Visual category identification
- **Bulk Category Operations**: Mass category updates

### Product Operations
- **Create Products**: Add new items to catalog
- **Edit Products**: Modify existing product details
- **Delete Products**: Remove products (with confirmation)
- **Duplicate Products**: Clone existing products
- **Import/Export**: Bulk product data operations

---

## Stock Management

### Stock Overview
- **Current Inventory**: Real-time stock levels
- **Low Stock Alerts**: Automatic notifications
- **Stock Value**: Total inventory value calculations
- **Location Tracking**: Multi-location stock management

### Purchase Orders
- **Order Creation**: Create supplier purchase orders with multiple items
- **Supplier Management**: Vendor contact information and tracking
- **Order Tracking**: PO status (pending, completed, cancelled)
- **Due Date Management**: Order deadline tracking with reminders
- **Cost Tracking**: Purchase order expenses and budgeting
- **Multi-item Orders**: Add multiple products to single PO
- **Quantity Specification**: Set quantities for each item
- **Price Per Unit**: Track cost per item
- **Total Calculation**: Automatic PO total calculations
- **Completion Workflow**: Mark orders as received/completed
- **Stock Auto-update**: Automatic inventory updates on completion

### Stock Adjustments
- **Manual Adjustments**: Increase/decrease inventory
- **Reason Tracking**: Adjustment justification
- **Audit Trail**: Complete adjustment history
- **Bulk Adjustments**: Mass inventory updates

### Stock History
- **Transaction Log**: All stock movements
- **Supplier Tracking**: Purchase order history
- **Adjustment Records**: Manual change history
- **Reporting**: Stock movement analytics

---

## Order Management

### Order Processing
- **Order Creation**: New order entry
- **Order Status**: Pending, processing, completed, cancelled
- **Customer Assignment**: Link orders to customers
- **Payment Processing**: Multiple payment methods
- **Discount Application**: Order-level discounts

### Order Details
- **Line Items**: Product quantities and pricing
- **Order Totals**: Subtotal, tax, discount, total
- **Customer Information**: Contact and delivery details
- **Order Notes**: Special instructions
- **Order History**: Status change tracking

### Order Operations
- **Order Editing**: Modify existing orders
- **Order Cancellation**: Cancel with reason
- **Refund Processing**: Return and refund management
- **Order Search**: Find orders by various criteria

### Payment Change Requests
- **Request Review**: Review cashier payment method change requests
- **Approval Workflow**: Approve or deny payment changes
- **Audit Trail**: Complete history of payment modifications
- **Reason Tracking**: View reason for payment change requests
- **Employee Tracking**: See who initiated the request

### Refund Management
- **Refund Requests**: Review refund requests from cashiers
- **Approval System**: Approve or reject refund requests
- **Refund History**: Complete refund audit trail
- **Amount Verification**: Review refund amounts and reasons
- **Customer Communication**: Notes and communication tracking

### Date & Amount Filtering
- **Date Range Selection**: Today, yesterday, week, month, custom
- **Amount Range Filter**: Min/max amount filtering
- **Receipt Type Filter**: Sales vs Refunds
- **Source Filter**: POS, online, or other sources
- **Payment Type Filter**: Cash, card, transfer, crypto

---

## Customer Management

### Customer Database
- **Customer Profiles**: Complete customer information
- **Contact Details**: Phone, email, address
- **Purchase History**: Complete transaction records
- **Loyalty Points**: Cashback and rewards tracking
- **Customer Segmentation**: Customer categorization

### Customer Operations
- **Create Customers**: Add new customer profiles
- **Edit Customers**: Update customer information
- **Delete Customers**: Remove customer records
- **Merge Customers**: Combine duplicate profiles
- **Import Customers**: Bulk customer data import

### Customer Analytics
- **Lifetime Value**: Total customer spending
- **Purchase Frequency**: Buying pattern analysis
- **Average Order Value**: Customer spending metrics
- **Customer Segmentation**: Group analysis
- **Retention Tracking**: Customer loyalty metrics

### Points & Rewards
- **Points Balance**: Current loyalty points
- **Points History**: Earning and redemption records
- **Points Adjustment**: Manual points modification
- **Reward Rules**: Points earning configuration
- **Redemption Tracking**: Points usage history

---

## Shifts Management

### Overview
Complete shift tracking system for employee work periods, cash management, and performance monitoring.

### Shift Operations
- **Open Shift**: Start new shift with opening cash amount
- **Close Shift**: End shift with closing cash reconciliation
- **Active Shifts**: View currently active employee shifts
- **Shift History**: Complete historical shift records

### Cash Management
- **Opening Cash**: Record starting cash drawer amount
- **Closing Cash**: Record ending cash drawer amount
- **Cash Variance**: Automatic over/short calculations
- **Expected vs Actual**: Compare expected revenue to actual cash
- **Cash Reconciliation**: Detailed cash counting and verification

### Shift Tracking
- **Employee Assignment**: Link shifts to specific employees
- **Time Tracking**: Start time, end time, duration
- **Sales Performance**: Revenue generated during shift
- **Transaction Count**: Number of transactions processed
- **Average Transaction**: Average sale value per transaction

### Shift Statistics
- **Total Revenue**: Sales during shift period
- **Cash Sales**: Cash transactions total
- **Card Sales**: Card payment totals
- **Other Payments**: Alternative payment method totals
- **Discounts Given**: Total discounts applied during shift
- **Refunds Processed**: Refunds issued during shift

### Shift Details (Expandable)
- **Line Items Sold**: All products sold during shift
- **Product Quantities**: Units sold per product
- **Revenue by Product**: Sales breakdown by item
- **Payment Breakdown**: Detailed payment method analysis
- **Customer Count**: Number of unique customers served

### Filtering & Search
- **Employee Filter**: View shifts by specific employee
- **Date Range Filter**: Today, week, month, year, custom
- **Status Filter**: Active, completed, or all shifts
- **Search**: Search by employee name or shift ID

### Shift Reporting
- **User Performance Reports**: Employee-specific shift analytics
- **Total Shifts Worked**: Count of shifts per employee
- **Total Revenue Generated**: Employee revenue contribution
- **Average Shift Revenue**: Performance metrics per employee
- **Cash Handling Accuracy**: Over/short tracking per employee

---

## Expense Management

### Expense Creation
- **Multi-currency Support**: 15+ currency options
- **Category Classification**: Expense categorization
- **Receipt Attachment**: Digital receipt storage
- **Approval Workflow**: Expense approval process
- **Internal Notes**: Additional context and notes

### Expense Approval System
- **Pending Expenses**: Awaiting approval queue
- **Approval Actions**: Approve or deny expenses
- **Approval Notes**: Review comments and justification
- **Auto-approval**: Admin-created expenses auto-approve
- **Approval History**: Complete audit trail

### Expense Features
- **Advanced Filtering**: Search by category, currency, source
- **Source Tracking**: POS, Android, BackOffice origin
- **Real-time Updates**: Live expense synchronization
- **Export Capabilities**: Expense data export
- **Recurring Expenses**: Scheduled expense tracking

### Multi-currency Support
- **Supported Currencies**: USD, EUR, GBP, JPY, CAD, AUD, CHF, CNY, INR, MXN, BRL, ZAR, SGD, HKD, SEK
- **Exchange Rates**: Automatic rate updates
- **Currency Conversion**: Real-time conversion calculations
- **Base Currency**: Configurable base currency
- **Display Currency**: Choose display currency for viewing all expenses
- **Currency Search**: Quick currency selector with search

### Expense Category Management
- **Create Categories**: Add new expense categories
- **Edit Categories**: Modify existing category names and descriptions
- **Delete Categories**: Remove unused categories (with confirmation)
- **Category Description**: Add context to each category
- **Active Status**: Enable/disable categories
- **Usage Tracking**: See which expenses use each category
- **Category History**: Track category modifications
- **Soft Delete**: Preserve category history when deleting

### Expense Filtering & Search (Advanced)
- **Text Search**: Search descriptions, notes, employee names, approval notes
- **Category Filter**: Filter by expense category
- **Currency Filter**: Filter by transaction currency
- **Source Filter**: POS, Android, BackOffice
- **Employee Filter**: Filter by who created expense
- **Date Range Filter**: Custom date ranges with picker
- **Status Filter**: Pending, Approved, Denied
- **Multiple Filters**: Combine multiple filters simultaneously

### Expense Statistics & Totals
- **Pending Total**: Sum of all pending expenses
- **Approved Total**: Sum of all approved expenses
- **Denied Total**: Sum of all denied expenses
- **Currency Conversion**: View totals in chosen display currency
- **Period Analysis**: Expense totals by time period
- **Category Breakdown**: Spending by category
- **Employee Analysis**: Expenses by employee

---

## Cashback System

### Points Management
- **Points Earning**: Automatic points on purchases
- **Points Balance**: Real-time points tracking
- **Points Expiration**: Configurable expiration rules
- **Points Transfer**: Customer-to-customer transfers
- **Points History**: Complete transaction log per customer

### Cashback Rule Management
- **Rule Creation**: Create category or product-specific cashback rules
- **Rule Types**: Percentage-based or fixed amount cashback
- **Target Selection**: Apply rules to specific categories or products
- **Minimum Order**: Set minimum purchase requirements
- **Rule Status**: Enable/disable rules individually
- **Multiple Rules**: Support multiple concurrent cashback rules
- **Rule Priority**: Manage rule precedence and conflicts

### Rule Configuration Details
- **Rule Name**: Descriptive name for each rule
- **Rule Type**: Category-based or Product-based
- **Target Selection**: Choose specific categories or products
- **Cashback Type**: Percentage or fixed amount
- **Cashback Value**: Set reward amount or percentage
- **Minimum Order Amount**: Optional minimum purchase requirement
- **Active Status**: Enable/disable individual rules

### Point Usage Rules
- **Point Value**: Configure how much 1 point is worth (e.g., 1 point = ฿1)
- **Price When Using Points**: Member price or regular price
- **Earn Cashback on Point Usage**: Allow earning points when redeeming
- **Maximum Point Usage**: Limit percentage of order payable with points
- **Minimum Points to Redeem**: Set minimum points required for redemption

### Reward Configuration
- **Earning Rules**: Points per dollar/currency spent
- **Redemption Options**: Points to cash/discount conversion
- **Tier System**: Loyalty program levels (if applicable)
- **Reward Catalog**: Available redemption options

### Cashback Operations
- **Manual Adjustments**: Admin points modification
- **Add Points**: Manually add points to customer accounts
- **Reduce Points**: Manually deduct points with reason
- **Bulk Operations**: Mass points adjustments
- **Points History**: Complete transaction log
- **Reporting**: Cashback program analytics

### Cashback Analytics
- **Total Points Issued**: Aggregate points distributed
- **Total Points Redeemed**: Points used by customers
- **Active Point Balance**: Outstanding points across all customers
- **Rule Performance**: Which rules generate most engagement
- **Customer Participation**: Percentage of customers using cashback

---

## User Management

### User Roles & Permissions
- **Role Types**: Admin, Cashier, Employee
- **Permission Groups**: Price, Stock, Product, Customer management
- **Granular Permissions**: Specific action controls
- **Role Assignment**: User role configuration

### User Operations
- **Create Users**: Add new system users
- **Edit Users**: Modify user profiles and permissions
- **Delete Users**: Remove user accounts
- **Password Reset**: Admin password management
- **User Activity**: Login and action tracking

### Permission Matrix
| Permission | Admin | Cashier | Employee |
|------------|-------|---------|----------|
| Change Prices | ✅ | ❌ | ❌ |
| Modify Stock | ✅ | ❌ | ❌ |
| Add Products | ✅ | ❌ | ❌ |
| Edit Products | ✅ | ❌ | ❌ |
| Delete Products | ✅ | ❌ | ❌ |
| Manage Customers | ✅ | ✅ | ❌ |
| Create Expenses | ✅ | ✅ | ✅ |
| Approve Expenses | ✅ | ❌ | ❌ |

---

## Analytics

### Advanced Analytics Features
- **Custom Dashboards**: Personalized analytics views
- **Real-time Data**: Live business metrics
- **Trend Analysis**: Historical performance trends
- **Predictive Analytics**: Sales forecasting
- **Comparative Analysis**: Period-over-period comparisons

### Analytics Categories
- **Sales Analytics**: Revenue, profit, margin analysis
- **Customer Analytics**: Behavior, segmentation, lifetime value
- **Product Analytics**: Performance, popularity, profitability
- **Operational Analytics**: Efficiency, productivity metrics
- **Financial Analytics**: Cost, expense, cash flow analysis

---

## Integration Management

### Loyverse Integration
- **API Configuration**: Loyverse API credentials and token management
- **Data Synchronization**: Automatic bidirectional data sync
- **Sync Scheduling**: Configurable sync intervals (15, 30, 60 minutes)
- **Sync History**: Complete synchronization logs with timestamps
- **Error Handling**: Sync failure management and retry logic
- **Connection Status**: Real-time API connection monitoring

### Sync Operations
- **Categories Sync**: Product category synchronization from Loyverse
- **Products Sync**: Complete item catalog synchronization
- **Customers Sync**: Customer database synchronization
- **Receipts Sync**: Transaction history sync with line items
- **Stock Sync**: Inventory level synchronization
- **Payment Types Sync**: Payment method synchronization

### Manual Sync Features
- **Sync All**: Sync all data types at once
- **Selective Sync**: Sync individual data types
- **Force Sync**: Override cache and force fresh data pull
- **Sync Progress**: Real-time progress indicators
- **Sync Status**: Current/Total/Percentage for each sync type

### Auto-sync Configuration
- **Enable/Disable**: Toggle automatic synchronization
- **Interval Setting**: Set sync frequency (15, 30, 60 minutes)
- **Last Sync Time**: Display time of last successful sync
- **Next Sync Schedule**: Show when next auto-sync will occur
- **Sync on Startup**: Option to sync when opening dashboard

### Integration Features
- **Manual Sync**: On-demand data synchronization
- **Auto-sync**: Scheduled automatic sync with configurable intervals
- **Sync Monitoring**: Real-time sync status and progress tracking
- **Conflict Resolution**: Automatic data conflict management
- **Backup & Recovery**: Data integrity protection
- **Debug Information**: Detailed sync logs for troubleshooting

### Sync History & Logging
- **Complete Log**: Historical record of all sync operations
- **Sync Results**: Success/failure status for each sync
- **Records Processed**: Count of items synced per operation
- **Error Details**: Specific error messages for failed syncs
- **Performance Metrics**: Sync duration and speed
- **Filter by Type**: View history for specific sync types

### Data Management
- **Cursor-based Pagination**: Handle large datasets efficiently
- **Incremental Sync**: Sync only changes since last sync
- **Batch Processing**: Process large data sets in manageable chunks
- **Rate Limiting**: Respect API rate limits
- **Retry Logic**: Automatic retry on temporary failures

---

## Settings & Configuration

### System Settings
- **Business Information**: Company details configuration
- **Store Settings**: Location and operation settings
- **Tax Configuration**: Tax rate and rule setup
- **Currency Settings**: Base currency and exchange rates
- **Receipt Configuration**: Receipt format and printing settings
- **Business Hours**: Operating hours configuration

### Currency Exchange Rates
- **Base Currency**: Set default currency (e.g., THB, USD)
- **Exchange Rate Management**: Update currency conversion rates
- **Rate Source**: Manual or automatic rate updates
- **Rate History**: Track historical exchange rates
- **Multi-currency Display**: View all supported currencies
- **Rate Refresh**: Manual refresh of exchange rates
- **Last Updated**: Display last rate update timestamp
- **Currency Search**: Quick search for specific currencies

### User Interface Settings
- **Theme Configuration**: Light/dark mode, custom colors
- **Primary Color**: Choose main theme color
- **Secondary Color**: Choose accent color
- **Theme Mode**: Light, dark, or system default
- **Layout Preferences**: Dashboard and interface customization
- **Notification Settings**: Alert and notification preferences
- **Language Settings**: Multi-language support (when available)
- **Reset Theme**: Restore default theme settings

### Security Settings
- **Password Policies**: Password complexity requirements
- **Session Management**: Login session duration controls
- **Access Logging**: User activity monitoring and audit logs
- **Data Encryption**: Sensitive data protection settings
- **Two-Factor Authentication**: 2FA configuration (if enabled)
- **IP Whitelisting**: Restrict access by IP address

### Integration Settings
- **API Keys**: Third-party service credentials
- **Webhook Configuration**: External service integration
- **Data Export**: Automated data export settings
- **Backup Settings**: Data backup frequency and location
- **Sync Settings**: Auto-sync configuration for integrations

### Notification Settings
- **Low Stock Alerts**: Inventory threshold notifications
- **Expense Approvals**: Expense request notifications
- **Payment Changes**: Payment modification alerts
- **Refund Requests**: Refund approval notifications
- **Daily Reports**: Automated daily summary emails
- **Email Configuration**: SMTP settings for notifications

### Data Management
- **Database Statistics**: Storage usage and record counts
- **Data Export**: Export data to CSV, Excel, or JSON
- **Data Import**: Import products, customers, or other data
- **Backup & Restore**: Manual backup and restoration
- **Data Cleanup**: Remove old or unused records
- **Cache Management**: Clear cached data

### PWA (Progressive Web App) Settings
- **PWA Installation**: Guide for installing as app
- **Offline Support**: Offline functionality configuration
- **Update Notifications**: App update alerts
- **Cache Strategy**: Configure offline caching behavior

---

## API Endpoints

### Base URL
```
https://your-domain.vercel.app/api
```

### Authentication
All endpoints require JWT Bearer token in header:
```
Authorization: Bearer <JWT_TOKEN>
```

### Authentication Endpoints
```
POST /api/auth/login
Body: { email, password }
Response: { token, user: { id, email, name, role } }

POST /api/auth/register  
Body: { email, password, name, role }
Response: { success, userId }

POST /api/auth/reset-password
Body: { email }
Response: { success, message }

GET /api/auth/verify
Headers: Authorization: Bearer <token>
Response: { valid: true, user: {...} }
```

### Product Management
```
GET /api/products
Query: ?category=<id>&search=<term>&availability=<available|unavailable|all>
Response: { products: [...] }

POST /api/products
Body: { name, description, price, category, stock, trackStock, ... }
Response: { success, productId }

PUT /api/products/{id}
Body: { name, price, stock, ... }
Response: { success, product: {...} }

DELETE /api/products/{id}
Response: { success, message }

GET /api/categories
Response: { categories: [...] }

POST /api/categories
Body: { name, color, description }
Response: { success, categoryId }

PUT /api/categories/{id}
Body: { name, color, description }
Response: { success }

DELETE /api/categories/{id}
Response: { success }
```

### Customer Management
```
GET /api/customers
Query: ?search=<term>&source=<local>
Response: { customers: [...] }

POST /api/customers
Body: { name, email, phone, address, notes }
Response: { success, customerId }

PUT /api/customers/{id}
Body: { name, email, phone, ... }
Response: { success, customer: {...} }

DELETE /api/customers/{id}
Response: { success }

GET /api/customers/{id}/history
Response: { purchases: [...], totalSpent, orderCount }

GET /api/customers/{id}/points
Response: { points, pointList: [...], history: [...] }

POST /api/customers/{id}/points/adjust
Body: { amount, reason, type: 'add'|'reduce' }
Response: { success, newBalance }
```

### Sales & Orders
```
GET /api/orders
Query: ?status=<pending|completed|cancelled>&dateRange=<today|week|month|custom>&startDate=<date>&endDate=<date>
Response: { orders: [...], pagination: {...} }

POST /api/orders
Body: { customerId, items: [...], paymentMethod, discount, ... }
Response: { success, orderId, receiptId }

PUT /api/orders/{id}
Body: { status, items, ... }
Response: { success, order: {...} }

GET /api/receipts
Query: ?dateRange=<range>&paymentType=<type>&minAmount=<num>&maxAmount=<num>
Response: { receipts: [...], totalReceipts, totalRevenue }

GET /api/receipts/{id}
Response: { receipt: {...}, lineItems: [...] }

POST /api/orders/{id}/refund
Body: { reason, amount, items: [...] }
Response: { success, refundId }

GET /api/reports/sales
Query: ?startDate=<date>&endDate=<date>&groupBy=<day|week|month>&employeeId=<id>
Response: { sales: [...], totals: {...}, charts: {...} }

GET /api/reports/sales-by-item
Response: { items: [...], topItems: [...] }

GET /api/reports/sales-by-category
Response: { categories: [...], topCategories: [...] }

GET /api/reports/sales-by-employee
Response: { employees: [...], performance: {...} }

GET /api/reports/sales-by-payment
Response: { paymentMethods: [...], distribution: {...} }
```

### Stock Management
```
GET /api/stock
Query: ?lowStockOnly=<true|false>
Response: { products: [...], lowStockCount }

POST /api/stock/adjust
Body: { productId, quantity, reason, type: 'add'|'remove' }
Response: { success, newStock }

GET /api/stock/history
Query: ?productId=<id>&startDate=<date>&endDate=<date>
Response: { history: [...] }

GET /api/stock/purchase-orders
Response: { orders: [...] }

POST /api/stock/purchase-orders
Body: { supplier, items: [...], dueDate, notes }
Response: { success, orderId }

PUT /api/stock/purchase-orders/{id}
Body: { status: 'completed'|'cancelled', ... }
Response: { success }

DELETE /api/stock/purchase-orders/{id}
Response: { success }
```

### Expense Management
```
GET /api/mobile?action=get-expense-categories
Response: { success, categories: [...] }

POST /api/mobile?action=create-expense-category
Body: { name, description }
Response: { success, categoryId }

PUT /api/mobile?action=edit-expense-category
Body: { id, name, description }
Response: { success }

DELETE /api/mobile?action=delete-expense-category
Body: { id }
Response: { success }

GET /api/mobile?action=get-expenses
Query: &status=<pending|approved|denied>&startDate=<date>&endDate=<date>
Response: { success, expenses: [...] }

POST /api/mobile?action=create-expense
Body: { category, amount, currency, description, notes, date, time }
Response: { success, expense: {...} }

PUT /api/mobile?action=edit-expense
Body: { id, category, amount, description, ... }
Response: { success }

DELETE /api/mobile?action=delete-expense
Body: { id }
Response: { success }

POST /api/mobile?action=approve-expense
Body: { id, approvalNotes }
Response: { success }

POST /api/mobile?action=deny-expense
Body: { id, approvalNotes }
Response: { success }
```

### Shifts Management
```
GET /api/shifts
Query: ?status=<active|completed>&employeeId=<id>&dateRange=<range>
Response: { shifts: [...], statistics: {...} }

POST /api/shifts/open
Body: { employeeId, startingCash }
Response: { success, shiftId }

POST /api/shifts/{id}/close
Body: { closingCash, notes }
Response: { success, shift: {...}, variance }

GET /api/shifts/{id}/details
Response: { shift: {...}, transactions: [...], products: [...] }
```

### User Management
```
GET /api/users
Response: { users: [...] }

POST /api/users
Body: { email, password, name, role, permissions: {...} }
Response: { success, userId }

PUT /api/users/{id}
Body: { name, role, permissions: {...} }
Response: { success, user: {...} }

DELETE /api/users/{id}
Response: { success }

POST /api/users/{id}/reset-password
Body: { newPassword }
Response: { success }

GET /api/users/{id}/activity
Response: { logs: [...], statistics: {...} }
```

### Cashback Management
```
GET /api/cashback/rules
Response: { rules: [...] }

POST /api/cashback/rules
Body: { name, type, targetId, cashbackType, cashbackValue, minimumOrderAmount, isActive }
Response: { success, ruleId }

PUT /api/cashback/rules/{id}
Body: { name, cashbackValue, isActive, ... }
Response: { success }

DELETE /api/cashback/rules/{id}
Response: { success }

GET /api/cashback/usage-rules
Response: { pointValue, priceWhenUsingPoints, earnCashbackWhenUsingPoints, ... }

PUT /api/cashback/usage-rules
Body: { pointValue, maxPointUsagePercent, minPointsToRedeem, ... }
Response: { success }
```

### Settings & Configuration
```
GET /api/settings
Response: { settings: {...} }

PUT /api/settings
Body: { businessInfo: {...}, taxRate, currency, ... }
Response: { success }

GET /api/currencies
Response: { currencies: [...], baseCurrency }

GET /api/currencies/rates
Response: { rates: {...}, lastUpdated, baseCurrency }

PUT /api/currencies/rates
Body: { rates: {...}, baseCurrency }
Response: { success }

POST /api/currencies/refresh
Response: { success, rates: {...}, lastUpdated }
```

### Analytics & Statistics
```
GET /api/analytics/dashboard
Query: ?dateRange=<range>&category=<id>
Response: { metrics: {...}, charts: {...}, topProducts: [...], topCustomers: [...] }

GET /api/analytics/sold-items
Query: ?dateRange=<range>&category=<id>
Response: { soldItems: [...], totalQuantity, totalRevenue }

GET /api/analytics/transactions
Query: ?dateRange=<range>&customerId=<id>
Response: { transactions: [...], statistics: {...} }
```

---

## Implementation Notes for Xcode App

### UI/UX Considerations
- **Responsive Design**: Mobile-first approach for iOS
- **Navigation Structure**: Tab-based navigation matching web layout
- **Data Tables**: Optimized for mobile viewing
- **Charts**: iOS-native charting components
- **Offline Support**: Local data caching for offline operation

### Technical Requirements
- **iOS Version**: Minimum iOS 14.0
- **Network Layer**: URLSession for API communication
- **Data Storage**: Core Data for local caching
- **Authentication**: JWT token management
- **Real-time Updates**: WebSocket or polling for live data

### Key Features to Implement
1. **Secure Authentication**: JWT-based login system
2. **Dashboard**: Key metrics and charts
3. **CRUD Operations**: Full create, read, update, delete for all entities
4. **Offline Mode**: Local data storage and sync
5. **Push Notifications**: Real-time alerts
6. **Data Export**: PDF and CSV export capabilities
7. **Multi-language**: Localization support
8. **Theme Support**: Light/dark mode

### Data Models

#### Product Model
```swift
struct Product: Codable, Identifiable {
    let id: String
    var name: String
    var description: String?
    var price: Double
    var cost: Double?
    var categoryId: String?
    var categoryName: String?
    var stock: Int
    var trackStock: Bool
    var lowStockAlert: Int?
    var sku: String?
    var barcode: String?
    var imageUrl: String?
    var color: String?
    var isAvailable: Bool
    var source: String // "local"
    var createdAt: Date
    var updatedAt: Date
}
```

#### Customer Model
```swift
struct Customer: Codable, Identifiable {
    let id: String
    var name: String
    var email: String?
    var phone: String?
    var address: String?
    var notes: String?
    var totalSpent: Double
    var orderCount: Int
    var points: Double
    var pointList: [PointTransaction]
    var expiresAt: Date?
    var source: String // "local"
    var createdAt: Date
    var updatedAt: Date
}

struct PointTransaction: Codable {
    let id: String
    let amount: Double
    let reason: String
    let type: String // "earned" or "redeemed"
    let createdAt: Date
    let createdBy: String?
}
```

#### Order/Receipt Model
```swift
struct Receipt: Codable, Identifiable {
    let id: String
    let receiptNumber: String
    let receiptType: String // "SALE" or "REFUND"
    var customerId: String?
    var customerName: String?
    var employeeId: String
    var employeeName: String
    var lineItems: [LineItem]
    var subtotal: Double
    var discount: Double
    var tax: Double
    var total: Double
    var payments: [Payment]
    var source: String
    var shiftId: String?
    var notes: String?
    var receiptDate: Date
    var createdAt: Date
}

struct LineItem: Codable {
    let productId: String
    let itemName: String
    let quantity: Int
    let price: Double
    let discount: Double
    let total: Double
    let cost: Double?
}

struct Payment: Codable {
    let type: String // "Cash", "Card", "Transfer", etc.
    let name: String
    let amount: Double
}
```

#### Expense Model
```swift
struct Expense: Codable, Identifiable {
    let id: String
    var category: String
    var amount: Double
    var currency: String
    var description: String
    var notes: String?
    var date: String
    var time: String
    var status: String // "pending", "approved", "denied"
    var source: String // "POS", "Android", "BackOffice"
    var createdBy: String
    var createdByName: String
    var createdByRole: String
    var approvedBy: String?
    var approvedByName: String?
    var approvedAt: Date?
    var approvalNotes: String?
    var createdAt: Date
}

struct ExpenseCategory: Codable, Identifiable {
    let id: String
    var name: String
    var description: String?
    var active: Bool
    var createdAt: Date
}
```

#### User Model
```swift
struct User: Codable, Identifiable {
    let id: String
    var email: String
    var name: String
    var role: String // "admin", "cashier", "employee"
    var permissions: Permissions?
    var pin: String?
    var isActive: Bool
    var createdAt: Date
    var lastLogin: Date?
}

struct Permissions: Codable {
    var canChangePrice: Bool
    var canChangeStock: Bool
    var canAddProduct: Bool
    var canEditProduct: Bool
    var canDeleteProduct: Bool
    var canManageCustomers: Bool
    var canCreateExpenses: Bool
    var canApproveExpenses: Bool
}
```

#### Shift Model
```swift
struct Shift: Codable, Identifiable {
    let id: String
    var employeeId: String
    var employeeName: String
    var status: String // "active" or "completed"
    var startTime: Date
    var endTime: Date?
    var startingCash: Double
    var closingCash: Double?
    var expectedCash: Double?
    var cashVariance: Double?
    var totalRevenue: Double
    var transactionCount: Int
    var notes: String?
    var createdAt: Date
}
```

#### Cashback Rule Model
```swift
struct CashbackRule: Codable, Identifiable {
    let id: String
    var name: String
    var type: String // "category" or "product"
    var targetId: String
    var targetName: String
    var cashbackType: String // "percentage" or "fixed"
    var cashbackValue: Double
    var hasMinimumOrder: Bool
    var minimumOrderAmount: Double
    var isActive: Bool
    var createdAt: Date
}

struct PointUsageRules: Codable {
    var pointValue: Double
    var priceWhenUsingPoints: String // "member" or "regular"
    var earnCashbackWhenUsingPoints: Bool
    var maxPointUsagePercent: Int
    var minPointsToRedeem: Int
}
```

#### Stock Models
```swift
struct PurchaseOrder: Codable, Identifiable {
    let id: String
    var supplier: String
    var items: [PurchaseOrderItem]
    var totalCost: Double
    var dueDate: Date
    var status: String // "pending" or "completed"
    var notes: String?
    var createdAt: Date
    var completedAt: Date?
}

struct PurchaseOrderItem: Codable {
    let productId: String
    let productName: String
    let quantity: Int
    let costPerUnit: Double
    let total: Double
}

struct StockAdjustment: Codable, Identifiable {
    let id: String
    var productId: String
    var productName: String
    var type: String // "add" or "remove"
    var quantity: Int
    var reason: String
    var performedBy: String
    var performedByName: String
    var createdAt: Date
}
```

#### Settings Model
```swift
struct Settings: Codable {
    var businessName: String?
    var businessAddress: String?
    var businessPhone: String?
    var businessEmail: String?
    var baseCurrency: String
    var taxRate: Double
    var lowStockThreshold: Int
    var autoSyncEnabled: Bool
    var syncIntervalMinutes: Int
    var theme: ThemeSettings
}

struct ThemeSettings: Codable {
    var mode: String // "light", "dark", "system"
    var primaryColor: String
    var secondaryColor: String
}

struct ExchangeRates: Codable {
    var baseCurrency: String
    var rates: [String: Double]
    var lastUpdated: Date
}
```

---

## Implementation Notes for Xcode App